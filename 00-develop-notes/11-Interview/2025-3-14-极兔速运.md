---

title: 2025-3-14-极兔速运
created: 2025-03-16
tags:
    - Interview

---

**Q：项目中使用注册中心了吗？**  
A：是的，我们项目中使用了注册中心（如Nacos、Eureka或Zookeeper）。注册中心主要用于服务的动态注册与发现，能有效管理分布式系统中服务的元数据和健康状态，帮助实现服务调用的负载均衡和故障转移

**Q：如果让你设计一个注册中心，你会怎么实现？**  
A：我会从以下方面设计：  

1. **服务注册与发现**：提供API供服务注册元数据（如IP、端口），并支持服务查询。  
2. **心跳机制**：通过定期心跳检测服务存活状态，自动剔除失效节点。  
3. **集群化部署**：多节点组成集群，通过数据同步（如Raft协议）保证一致性
4. **数据存储**：使用内存或分布式存储（如Redis、Etcd）快速响应查询。  
5. **负载均衡**：集成客户端/服务端负载策略（如轮询、权重）。  

**Q：如何保证注册中心的高可用？**  
A：通过以下方式：  

1. **多节点集群**：避免单点故障，如使用主从复制或分布式一致性协议（如ZAB、Raft）
2. **数据冗余**：跨机房或可用区部署，确保数据同步
3. **自动故障转移**：通过健康检查快速切换主节点
4. **限流与熔断**：防止流量洪峰导致服务崩溃。  

**Q：如果同时进来10000个注册进去，你怎么处理？**  
A：应对高并发注册：  

1. **异步处理**：将注册请求写入队列（如Kafka）异步消费，避免阻塞。  
2. **分片存储**：按服务类型或哈希分片分散压力
3. **批量提交**：合并多个注册请求批量写入数据库。  
4. **限流降级**：通过令牌桶或漏桶算法控制请求速率。  

**Q：数据库死锁怎么处理，如何避免？**  
A：  

- **处理**：监控死锁日志，自动回滚代价小的事务，并重试
- **避免**：  
  1. 按固定顺序访问资源（如统一先更新表A再表B）。  
  2. 减少事务执行时间，避免长事务
  3. 使用低隔离级别（如READ COMMITTED）。  

**Q：为什么不去把存储过程改成SQL？**  
A：存储过程适合复杂业务逻辑封装，但在微服务架构中：  

1. **维护性差**：业务逻辑分散在数据库和代码中，难以调试。  
2. **移植性低**：存储过程语法依赖特定数据库（如Oracle PL/SQL）。  
3. **性能瓶颈**：复杂存储过程可能导致数据库负载过高，难以水平扩展

**Q：SQL优化的方法有哪些？**  
A：常用方法包括：  

1. **索引优化**：添加合适索引，避免全表扫描。  
2. **避免SELECT***：仅查询必要字段。  
3. **分页优化**：使用游标或延迟关联。  
4. **执行计划分析**：通过EXPLAIN定位慢查询
5. **分区表**：按时间或范围拆分大表

**Q：为什么不去使用Dubbo？**  
A：可能因为：  

1. **技术栈适配**：项目已基于Spring Cloud生态（如Feign、Ribbon）。  
2. **协议差异**：Dubbo默认使用私有RPC协议，而HTTP/REST更通用。  
3. **治理需求**：若需更强服务治理能力，Dubbo是可选方案，但需权衡复杂度

**Q：Oracle的索引是怎么实现的？**  
A：Oracle主要使用两种索引：  

1. **B树索引**：默认结构，适合等值查询和范围扫描，叶子节点存储行ID（ROWID）。  
2. **位图索引**：适用于低基数列（如性别），通过位图快速定位数据。  
索引设计需结合查询模式和数据分布，避免过度索引导致写性能下降

Q：**说一下 Spring 的 AutoConfiguration 是怎么实现的？**
A：https://developer.aliyun.com/article/1327091